{
	"name": "PL/php Development",
	"build": {
		"dockerfile": "Dockerfile",
		"context": ".."
	},

	// Mount volumes for persistent storage
	"mounts": [
		"source=plphp-php-build-cache,target=/opt/php-build,type=volume",
		"source=plphp-postgres-data,target=/var/lib/postgresql/data,type=volume"
	],

	// Set environment variables
	"containerEnv": {
		"POSTGRES_VERSION": "${localEnv:POSTGRES_VERSION:9.6}",
		"PHP_VERSION": "${localEnv:PHP_VERSION:5.6.40}"
	},

	// VSCode customizations
	"customizations": {
		"vscode": {
			"settings": {
				"terminal.integrated.defaultProfile.linux": "bash",
				"C_Cpp.default.includePath": [
					"${workspaceFolder}/**",
					"/usr/include/postgresql/9.6/server",
					"/opt/php-build/include/php",
					"/opt/php-build/include/php/main",
					"/opt/php-build/include/php/Zend",
					"/opt/php-build/include/php/TSRM"
				],
				"C_Cpp.default.defines": [
					"PG_VERSION_NUM=90600"
				],
				"C_Cpp.default.compilerPath": "/usr/bin/gcc",
				"files.associations": {
					"*.c": "c",
					"*.h": "c"
				}
			},
			"extensions": [
				"ms-vscode.cpptools",
				"ms-vscode.cpptools-extension-pack",
				"ckolkman.vscode-postgres",
				"eamodio.gitlens"
			]
		}
	},

	// Run commands after container is created
	"postCreateCommand": "bash .devcontainer/scripts/post-create.sh",

	// Keep container running
	"forwardPorts": [5432],

	// Use root user for setup (PostgreSQL installation requires it)
	"remoteUser": "root",

	// Don't override the container's default command
	"overrideCommand": false
}
